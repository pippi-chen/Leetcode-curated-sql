-- 1280. Students and Examinations
-- Write an SQL query to find the number of times each student attended each exam.
-- Order the result table by student_id and subject_name.

-- Create table
DROP TABLE STUDENTS;
CREATE TABLE STUDENTS (
 STUDENT_ID INT,
 STUDENT_NAME VARCHAR(10),
 PRIMARY KEY(STUDENT_ID)
);

DROP TABLE SUBJECTS;
CREATE TABLE SUBJECTS (
 SUBJECT_NAME VARCHAR(20) PRIMARY KEY
);

DROP TABLE EXAMINATIONS;
CREATE TABLE EXAMINATIONS (
 STUDENT_ID INT,
 SUBJECT_NAME VARCHAR(20)
);
 
INSERT INTO STUDENTS VALUES (1, 'Alice');
INSERT INTO STUDENTS VALUES (2, 'Bob');
INSERT INTO STUDENTS VALUES (13, 'John');
INSERT INTO STUDENTS VALUES (6, 'Alex');

INSERT INTO SUBJECTS VALUES ('Math');
INSERT INTO SUBJECTS VALUES ('Physics');
INSERT INTO SUBJECTS VALUES ('Programming');

INSERT INTO EXAMINATIONS VALUES (1, 'Math');
INSERT INTO EXAMINATIONS VALUES (1, 'Physics');
INSERT INTO EXAMINATIONS VALUES (1, 'Programming');
INSERT INTO EXAMINATIONS VALUES (2, 'Programming');
INSERT INTO EXAMINATIONS VALUES (1, 'Physics');
INSERT INTO EXAMINATIONS VALUES (1,  'Math');
INSERT INTO EXAMINATIONS VALUES (13, 'Math');
INSERT INTO EXAMINATIONS VALUES (13, 'Programming');
INSERT INTO EXAMINATIONS VALUES (13, 'Physics');
INSERT INTO EXAMINATIONS VALUES (2, 'Math');
INSERT INTO EXAMINATIONS VALUES (1, 'Math');
COMMIT;

-- Solution
SELECT S.STUDENT_ID, S.STUDENT_NAME, SUB.SUBJECT_NAME, COUNT(E.SUBJECT_NAME) ATTENDED_EXAMS
FROM STUDENTS S
JOIN SUBJECTS SUB
LEFT JOIN EXAMINATIONS E
ON S.STUDENT_ID = E.STUDENT_ID
	AND
    SUB.SUBJECT_NAME = E.SUBJECT_NAME
GROUP BY S.STUDENT_ID, SUB.SUBJECT_NAME;

